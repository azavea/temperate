<div [ngClass]="{'card': true, 'card-full': true, 'collapsed': isCollapsed}">
  <header class="card-header" role="tab">
    <button class="button button-link card-title-button" title="Add to top concerns"><i class="icon-plus-squared"></i><i class="icon-ok-squared hidden"></i></button>
    <button class="card-header-container card-toggle" (click)="isCollapsed = !isCollapsed">
      <h2 class="card-title">
        {{ indicator.label }}
      </h2>
      <i [ngClass]="{'icon-accordion': true, 'icon-angle-right': isCollapsed, 'icon-angle-down': !isCollapsed}"></i>
    </button>
  </header>
  <!--We only want to create and show selected indicator chart components to prevent clogging the page with unwanted requests and page updates. Below looks repetitive but [collapse] only provides the accordion UI action which shows/hides the chart guts but doesn't manage requests; *ngIf does that by actually creating/removing DOM components -->
  <div *ngIf="!isCollapsed" [collapse]="isCollapsed">
    <div class="chart card-block">
      <div class="chart-controls">
        <div class="chart-toggle">
          <span>Scenario</span>
          <ccc-scenario-toggle [scenario]="scenario"
                               (onScenarioSelected)="scenarioSelected($event)">
          </ccc-scenario-toggle>
        </div>
        <div class="chart-toggle">
          <span>Models</span>
          <ccc-model-modal [dataset]="dataset"
                           [models]="models"
                           (onModelsChanged)="modelsChanged($event)">
          </ccc-model-modal>
        </div>
        <div class="chart-toggle" *ngIf="indicator?.available_units">
          <span>Units</span>
          <ccc-units-dropdown [unit]="unit"
                              [units]="indicator.available_units"
                              (unitSelected)="unitSelected($event)"></ccc-units-dropdown>
        </div>
        <div class="chart-toggle">
          <span>Dataset</span>
          <ccc-dataset-toggle [dataset]="dataset"
                              [city]="city"
                              [models]="models"
                              (onDatasetSelected)="datasetSelected($event)">
          </ccc-dataset-toggle>
        </div>
      </div>
      <app-chart [indicator]="indicator"
             [city]="city"
             [models]="models"
             [dataset]="dataset"
             [scenario]="scenario"
             [unit]="unit"
             [extraParams]="extraParams"></app-chart>
    </div>
  </div>
</div>
